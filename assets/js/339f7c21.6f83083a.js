"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[286],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var i=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var d=i.createContext({}),l=function(e){var t=i.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=l(e.components);return i.createElement(d.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,d=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=l(a),m=n,g=p["".concat(d,".").concat(m)]||p[m]||h[m]||r;return a?i.createElement(g,s(s({ref:t},c),{},{components:a})):i.createElement(g,s({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=p;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var l=2;l<r;l++)s[l]=a[l];return i.createElement.apply(null,s)}return i.createElement.apply(null,a)}p.displayName="MDXCreateElement"},2622:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var i=a(7462),n=(a(7294),a(3905));const r={sidebar_position:3},s="Thingsboard Setup",o={unversionedId:"tutorial/Thingsboard - Rule Engine/Thingsboard",id:"tutorial/Thingsboard - Rule Engine/Thingsboard",title:"Thingsboard Setup",description:"Initial Situation",source:"@site/docs/tutorial/Thingsboard - Rule Engine/Thingsboard.md",sourceDirName:"tutorial/Thingsboard - Rule Engine",slug:"/tutorial/Thingsboard - Rule Engine/Thingsboard",permalink:"/tutorial/Thingsboard - Rule Engine/Thingsboard",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"KEYNOA Setup",permalink:"/tutorial/Thingsboard - Rule Engine/KEYNOA"},next:{title:"Next Steps",permalink:"/tutorial/Thingsboard - Rule Engine/next steps"}},d={},l=[{value:"Initial Situation",id:"initial-situation",level:2},{value:"Adapt Rule Chain",id:"adapt-rule-chain",level:2},{value:"Build Dashboard",id:"build-dashboard",level:2},{value:"Temperature Display",id:"temperature-display",level:3},{value:"Temperature Graph",id:"temperature-graph",level:3},{value:"Alarms Table",id:"alarms-table",level:3},{value:"Set Sending Interval",id:"set-sending-interval",level:3},{value:"Check incoming alarms",id:"check-incoming-alarms",level:2}],c={toc:l};function h(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,i.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"thingsboard-setup"},"Thingsboard Setup"),(0,n.kt)("h2",{id:"initial-situation"},"Initial Situation"),(0,n.kt)("p",null,"You are the IoT manager of a brewing and beverage factory.\nSince the products should only be stored at certain temperatures, it is essential for the entire operation to detect failures of the cooling systems in a timely manner.\nTo do this, you want to use sensors and IoT gateway at all storage points. "),(0,n.kt)("p",null,"In order to detect failures directly, you now use the Thingsboard Rule Chain.\nThe aim of this tutorial is to define a rule that immediately detects failures of the cooling system. "),(0,n.kt)("h2",{id:"adapt-rule-chain"},"Adapt Rule Chain"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"In Thingsboard Cloud go to Rule Chains section and open Root Rule Chain.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(3921).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Familiarise yourself with the rule chain. Focus only on the red area. Incoming messages are distributed via the switch. If a message contains telemetry data, it is stored. We now want to check the stored data.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(6883).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Create a new script via drag and drop. Enter a name and adapt the function as shown. Click on "Add".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(9788).Z,width:"1557",height:"887"})))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"return msg.temperature < 35;\n")),(0,n.kt)("ol",{start:4},(0,n.kt)("li",{parentName:"ol"},'Connect the "Save Timeseries" module with our script. You can connect the modules by dragging and dropping. Select the label ',(0,n.kt)("inlineCode",{parentName:"li"},"Success"),' and click on "Add".')),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(9991).Z,width:"1077",height:"217"})),(0,n.kt)("div",{style:{textAlign:"center"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(6657).Z,width:"475",height:"271"}))),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(6148).Z,width:"1136",height:"231"})),(0,n.kt)("ol",{start:5},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Create a "Create Alarm" block that triggers the alarm. Enter a name. The default code does not need to be changed.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(3164).Z,width:"1558",height:"885"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Create a "Clear Alarm" block that resolves the alarm. Enter a name. The default code does not need to be changed.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(2748).Z,width:"1554",height:"888"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Connect the new alarm modules to the Temperature Check. To do this, create two connections via drag and drop, as you have already done. Make sure that the conditions ",(0,n.kt)("inlineCode",{parentName:"p"},"False")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"True")," are set as shown in the screenshot.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(2623).Z,width:"986",height:"502"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Very Important:"),' Click on the "Apply Changes" Button at the bottom right to save all changes.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(7685).Z,width:"1808",height:"952"})))),(0,n.kt)("h2",{id:"build-dashboard"},"Build Dashboard"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'After customising the rule chain, we build a dashboard to visualise the alarms. Navigate to the section "Dashboards". At the top right you will find the "+" to create a new dashboard. Enter name and description.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(7315).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Open the newly created dashboard.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(9870).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Click on the Edit icon at the bottom right to add a new widget.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(7463).Z,width:"1808",height:"952"})))),(0,n.kt)("h3",{id:"temperature-display"},"Temperature Display"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'The first thing we want to do is create a temperature display. Select the widget type "Cards" for this.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(9769).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Choose Simple Card.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(4868).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Thingsboard uses aliases as data source. Therefore, for the first widget we need to create an alias. To do this, click on "Create a new one!".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(5512).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Enter the alias information shown in the screenshot below. For the device select your device.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(9404).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Now you can choose the newly created alias as data source. Choose "temperature" as attribute. Click "Add".\nCongratulations, you have created your first widget.\nHint: If you can\'t find the attribute temperature, the device hasn\'t sent data yet.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(6899).Z,width:"1808",height:"952"})))),(0,n.kt)("h3",{id:"temperature-graph"},"Temperature Graph"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'The second widget should display a graph showing the temperature curve. To do this, select "Add new widget" again via the button at the bottom right. Then select the widget type "Timeseires Line Chart".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(1526).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Insert the data shown below and click "Add".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(8242).Z,width:"1808",height:"952"})))),(0,n.kt)("h3",{id:"alarms-table"},"Alarms Table"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'The third widget should now show the incoming alarms. Therefore, add a new widget, this time with the type "Alarm widgets".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(6437).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Choose "Alarms table".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(2741).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Enter the two fields marked below. Select the "Active" and "Cleared" state as well as your Entity alias.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(3622).Z,width:"1808",height:"952"})))),(0,n.kt)("h3",{id:"set-sending-interval"},"Set Sending Interval"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'The fourth widget should enable you to adjust the sending interval of the device.\nAdd a new widge with the type "Input widgets".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(3397).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Choose "Update shared integer attribute".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(5971).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Select the entity and start tying in ",(0,n.kt)("inlineCode",{parentName:"p"},"sending_interval"),' into the data keys field.\nCreate that attribute by clicking the "A" icon.\nAfter that click on "Settings".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(1853).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Adjust the titel to "sending interval" and click on "Add".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(9292).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"You can adjust the sizes of the widget acording to your preferences.\n",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"Very Important:")),' Do not forget to click "Apply Changes" at the bottom right.\nOtherwise your Dashboard won\'t be saved.\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(6649).Z,width:"1808",height:"952"})))),(0,n.kt)("ol",{start:6},(0,n.kt)("li",{parentName:"ol"},"You can adjust the device sending interval by typing in the widget and confiming with the checkmark.\nSoon you can recognice that the interval between messages has changed.\n",(0,n.kt)("img",{alt:"Apply Changes",src:a(2411).Z,width:"1808",height:"952"}))),(0,n.kt)("h2",{id:"check-incoming-alarms"},"Check incoming alarms"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"If the temperature rises above 35\xb0, a new entry should occur in the Alarm table.\nThe rule we defined before triggers the action that creates a new alarm.\n",(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(2923).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'If the temperature falls below 35\xb0, the state of the alarm will change to "cleared".\n',(0,n.kt)("img",{alt:"Temperature Validation Node",src:a(8026).Z,width:"1808",height:"952"}))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"You can adapt the Dashboard according to your wishes. Insert widgets and explore the Thingsboard functionalities. "))),(0,n.kt)("p",null,"Success! You now have a digitalized brewing and beverage factory."))}h.isMDXComponent=!0},3622:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-alarm-table-data-f3416ab019fa29c53936f2d3a3a4caf7.png"},2741:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-alarm-table-5309d98f4e39a0db119bdee2e3143fd9.png"},6437:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-alarm-59ad76845a47ca8084b2f3099d25c806.png"},1853:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-input-create-attribute-799a4fbf891cf888f03f81a8e0abc9e5.png"},9292:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-input-settings-e612db8312bf0cd3feb4fc2a932d32a2.png"},5971:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-input-shared-int-58b7bc839cfc1b4350e1a004efda7558.png"},3397:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-input-5d04f64485932309d1ac1981446e21d3.png"},6899:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-simple-2-a1f253545add8b4637c04257fbb27dc8.png"},4868:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-simple-a86fda0ba879dbe09a22d0e5ef044891.png"},8242:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-timeseries-2-ea098921ccf9a65885d5041d2c79a496.png"},1526:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-timeseries-d29539c337b48b68f81356d948b27c1e.png"},9769:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-cards-e9aacf6cbbe88285c7ab38a6c10ee33c.png"},8026:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-check-alarms-2-5f1ea6c94c468ff4f01e0ae612322d6d.png"},2923:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-check-alarms-02f92631c30067fb0a6c03c1dfb271d1.png"},9404:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-create-data-source-2-4554b61649ef9b474aa16d9cdc028ae6.png"},5512:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-create-data-source-db17092b52366631188ded391b203197.png"},7463:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-empty-fa812d0e5df3988dce5880f69412baf2.png"},9870:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-open-eb9b33a2e3a72bb328bdf1cab2a60ea7.png"},6649:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-rearrange-cad964d890c0cff8681c5befed19718f.png"},2411:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-set-attribute-ae3d18c06ffd83aea7d823a4b887f358.png"},7315:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/dashboard-c2da857ad3e73d8b93d16ac2f2401fb3.png"},7685:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-apply-121f5dd0fa8c451043ef93140e344425.png"},2748:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-clear-alarm-b4297593825da717656ee2b357616913.png"},9991:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-connect-3c162f8934d61ddec7de2d96132c7fa3.png"},3164:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-create-alarm-0e451b7526f7253fc10099c634096a70.png"},6883:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-default-ef58469fe9a6262fc0d2e9e0bbb4a934.png"},2623:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-link-alarms-dea2531eed2184ab195769e1a9372b4c.png"},6148:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-link-complete-d80c1c9370163114df28b74a3a8b5af6.png"},6657:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-link-cbc7b362bf95967461691568c3d7f9a4.png"},9788:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-script-3dc7bd9fce1456e8e30bd75cda9e6039.png"},3921:(e,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/rule-chain-0de7acf40efa0bcc51f24b0b586899a0.png"}}]);